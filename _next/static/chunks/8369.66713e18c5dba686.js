!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="fe2426ec-a882-4594-ba21-b073f331ad1a",e._sentryDebugIdIdentifier="sentry-dbid-fe2426ec-a882-4594-ba21-b073f331ad1a")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8369],{38369:function(e,t,r){r.d(t,{ReCaptchaV3Provider:function(){return W},initializeAppCheck:function(){return U}});var n=r(46335),i=r(75664),o=r(97406),a=r(81891);let s=new Map,c={activated:!1,tokenObservers:[]},l={initialized:!1,enabled:!1};function h(e){return s.get(e)||Object.assign({},c)}let u="https://content-firebaseappcheck.googleapis.com/v1";class d{constructor(e,t,r,n,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=n,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=n,n>i)throw Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{var t;this.pending=new o.BH,this.pending.promise.catch(e=>{}),await (t=this.getNextRun(e),new Promise(e=>{setTimeout(e,t)})),this.pending.resolve(),await this.pending.promise,this.pending=new o.BH,this.pending.promise.catch(e=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(e){this.retryPolicy(e)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}let p=new o.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function f(e=!1){var t;return e?null===(t=self.grecaptcha)||void 0===t?void 0:t.enterprise:self.grecaptcha}function g(e){if(!h(e).activated)throw p.create("use-before-activation",{appName:e.name})}function k(e){let t=Math.round(e/1e3),r=Math.floor(t/86400),n=Math.floor((t-86400*r)/3600),i=Math.floor((t-86400*r-3600*n)/60),o="";return r&&(o+=w(r)+"d:"),n&&(o+=w(n)+"h:"),o+=w(i)+"m:"+w(t-86400*r-3600*n-60*i)+"s"}function w(e){return 0===e?"00":e>=10?e.toString():"0"+e}async function v({url:e,body:t},r){let n,i;let o={"Content-Type":"application/json"},a=r.getImmediate({optional:!0});if(a){let e=await a.getHeartbeatsHeader();e&&(o["X-Firebase-Client"]=e)}let s={method:"POST",body:JSON.stringify(t),headers:o};try{n=await fetch(e,s)}catch(e){throw p.create("fetch-network-error",{originalErrorMessage:null==e?void 0:e.message})}if(200!==n.status)throw p.create("fetch-status-error",{httpStatus:n.status});try{i=await n.json()}catch(e){throw p.create("fetch-parse-error",{originalErrorMessage:null==e?void 0:e.message})}let c=i.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw p.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${i.ttl}`});let l=1e3*Number(c[1]),h=Date.now();return{token:i.token,expireTimeMillis:h+l,issuedAtTimeMillis:h}}function m(e,t){let{projectId:r,appId:n,apiKey:i}=e.options;return{url:`${u}/projects/${r}/apps/${n}:exchangeDebugToken?key=${i}`,body:{debug_token:t}}}let b="firebase-app-check-store",E="debug-token",y=null;function T(){return y||(y=new Promise((e,t)=>{try{let r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=t=>{e(t.target.result)},r.onerror=e=>{var r;t(p.create("storage-open",{originalErrorMessage:null===(r=e.target.error)||void 0===r?void 0:r.message}))},r.onupgradeneeded=e=>{let t=e.target.result;0===e.oldVersion&&t.createObjectStore(b,{keyPath:"compositeKey"})}}catch(e){t(p.create("storage-open",{originalErrorMessage:null==e?void 0:e.message}))}}))}async function P(e,t){let r=(await T()).transaction(b,"readwrite"),n=r.objectStore(b).put({compositeKey:e,value:t});return new Promise((e,t)=>{n.onsuccess=t=>{e()},r.onerror=e=>{var r;t(p.create("storage-set",{originalErrorMessage:null===(r=e.target.error)||void 0===r?void 0:r.message}))}})}async function A(e){let t=(await T()).transaction(b,"readonly"),r=t.objectStore(b).get(e);return new Promise((e,n)=>{r.onsuccess=t=>{let r=t.target.result;r?e(r.value):e(void 0)},t.onerror=e=>{var t;n(p.create("storage-get",{originalErrorMessage:null===(t=e.target.error)||void 0===t?void 0:t.message}))}})}function C(e){return`${e.options.appId}-${e.name}`}let _=new a.Yd("@firebase/app-check");async function I(e){if((0,o.hl)()){let t;try{t=await A(C(e))}catch(e){_.warn(`Failed to read token from IndexedDB. Error: ${e}`)}return t}}function R(e,t){return(0,o.hl)()?P(C(e),t).catch(e=>{_.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}async function S(){let e;try{e=await A(E)}catch(e){}if(e)return e;{let e=(0,o.k$)();return P(E,e).catch(e=>_.warn(`Failed to persist debug token to IndexedDB. Error: ${e}`)),e}}function x(){return l.enabled}async function D(){if(l.enabled&&l.token)return l.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}let M={error:"UNKNOWN_ERROR"};async function $(e,t=!1){let r,n;let i=e.app;g(i);let o=h(i),a=o.token;if(a&&!K(a)&&(o.token=void 0,a=void 0),!a){let e=await o.cachedTokenPromise;e&&(K(e)?a=e:await R(i,void 0))}if(!t&&a&&K(a))return{token:a.token};let s=!1;if(x()){o.exchangeTokenPromise||(o.exchangeTokenPromise=v(m(i,await D()),e.heartbeatServiceProvider).finally(()=>{o.exchangeTokenPromise=void 0}),s=!0);let t=await o.exchangeTokenPromise;return await R(i,t),o.token=t,{token:t.token}}try{o.exchangeTokenPromise||(o.exchangeTokenPromise=o.provider.getToken().finally(()=>{o.exchangeTokenPromise=void 0}),s=!0),a=await h(i).exchangeTokenPromise}catch(e){"appCheck/throttled"===e.code?_.warn(e.message):_.error(e),n=e}return a?n?r=K(a)?{token:a.token,internalError:n}:F(n):(r={token:a.token},o.token=a,await R(i,a)):r=F(n),s&&z(i,r),r}async function N(e){let t=e.app;g(t);let{provider:r}=h(t);if(x()){let r=await D(),{token:n}=await v(m(t,r),e.heartbeatServiceProvider);return{token:n}}{let{token:e}=await r.getToken();return{token:e}}}function O(e,t,r,n){let{app:i}=e,o=h(i);if(o.tokenObservers=[...o.tokenObservers,{next:r,error:n,type:t}],o.token&&K(o.token)){let t=o.token;Promise.resolve().then(()=>{r({token:t.token}),H(e)}).catch(()=>{})}o.cachedTokenPromise.then(()=>H(e))}function B(e,t){let r=h(e),n=r.tokenObservers.filter(e=>e.next!==t);0===n.length&&r.tokenRefresher&&r.tokenRefresher.isRunning()&&r.tokenRefresher.stop(),r.tokenObservers=n}function H(e){let{app:t}=e,r=h(t),n=r.tokenRefresher;n||(n=function(e){let{app:t}=e;return new d(async()=>{let r;if((r=h(t).token?await $(e,!0):await $(e)).error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let e=h(t);if(!e.token)return 0;{let t=e.token.issuedAtTimeMillis+(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)*.5+3e5;return Math.max(0,(t=Math.min(t,e.token.expireTimeMillis-3e5))-Date.now())}},3e4,96e4)}(e),r.tokenRefresher=n),!n.isRunning()&&r.isTokenAutoRefreshEnabled&&n.start()}function z(e,t){for(let r of h(e).tokenObservers)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch(e){}}function K(e){return e.expireTimeMillis-Date.now()>0}function F(e){return{token:o.US.encodeString(JSON.stringify(M),!1),error:e}}class j{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=h(this.app);for(let t of e)B(this.app,t.next);return Promise.resolve()}}function L(e,t,r,n,i){r.ready(()=>{(function(e,t,r,n){let i=r.render(n,{sitekey:t,size:"invisible",callback:()=>{h(e).reCAPTCHAState.succeeded=!0},"error-callback":()=>{h(e).reCAPTCHAState.succeeded=!1}}),o=h(e);o.reCAPTCHAState=Object.assign(Object.assign({},o.reCAPTCHAState),{widgetId:i})})(e,t,r,n),i.resolve(r)})}async function q(e){g(e);let t=h(e).reCAPTCHAState,r=await t.initialized.promise;return new Promise((t,n)=>{let i=h(e).reCAPTCHAState;r.ready(()=>{t(r.execute(i.widgetId,{action:"fire_app_check"}))})})}class W{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e,t,r;let n;!function(e){if(e&&Date.now()-e.allowRequestsAfter<=0)throw p.create("throttled",{time:k(e.allowRequestsAfter-Date.now()),httpStatus:e.httpStatus})}(this._throttleData);let i=await q(this._app).catch(e=>{throw p.create("recaptcha-error")});if(!(null===(e=h(this._app).reCAPTCHAState)||void 0===e?void 0:e.succeeded))throw p.create("recaptcha-error");try{n=await v(function(e,t){let{projectId:r,appId:n,apiKey:i}=e.options;return{url:`${u}/projects/${r}/apps/${n}:exchangeRecaptchaV3Token?key=${i}`,body:{recaptcha_v3_token:t}}}(this._app,i),this._heartbeatServiceProvider)}catch(e){if(null===(t=e.code)||void 0===t?void 0:t.includes("fetch-status-error"))throw this._throttleData=function(e,t){if(404===e||403===e)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:e};{let r=t?t.backoffCount:0,n=(0,o.$s)(r,1e3,2);return{backoffCount:r+1,allowRequestsAfter:Date.now()+n,httpStatus:e}}}(Number(null===(r=e.customData)||void 0===r?void 0:r.httpStatus),this._throttleData),p.create("throttled",{time:k(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus});throw e}return this._throttleData=null,n}initialize(e){this._app=e,this._heartbeatServiceProvider=(0,n.qX)(e,"heartbeat"),(function(e,t){let r=new o.BH;h(e).reCAPTCHAState={initialized:r};let n=function(e){let t=`fire_app_check_${e.name}`,r=document.createElement("div");return r.id=t,r.style.display="none",document.body.appendChild(r),t}(e),i=f(!1);return i?L(e,t,i,n,r):function(e){let t=document.createElement("script");t.src="https://www.google.com/recaptcha/api.js",t.onload=e,document.head.appendChild(t)}(()=>{let i=f(!1);if(!i)throw Error("no recaptcha");L(e,t,i,n,r)}),r.promise})(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof W&&this._siteKey===e._siteKey}}function U(e=(0,n.Mq)(),t){e=(0,o.m9)(e);let r=(0,n.qX)(e,"app-check");if(l.initialized||function(){let e=(0,o.Rd)();if(l.initialized=!0,"string"!=typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN&&!0!==e.FIREBASE_APPCHECK_DEBUG_TOKEN)return;l.enabled=!0;let t=new o.BH;l.token=t,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN?t.resolve(e.FIREBASE_APPCHECK_DEBUG_TOKEN):t.resolve(S())}(),x()&&D().then(e=>console.log(`App Check debug token: ${e}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),r.isInitialized()){let n=r.getImmediate(),i=r.getOptions();if(i.isTokenAutoRefreshEnabled===t.isTokenAutoRefreshEnabled&&i.provider.isEqual(t.provider))return n;throw p.create("already-initialized",{appName:e.name})}let i=r.initialize({options:t});return function(e,t,r){var n;let i=(n=Object.assign({},c),s.set(e,n),s.get(e));i.activated=!0,i.provider=t,i.cachedTokenPromise=I(e).then(t=>(t&&K(t)&&(i.token=t,z(e,{token:t.token})),t)),i.isTokenAutoRefreshEnabled=void 0===r?e.automaticDataCollectionEnabled:r,i.provider.initialize(e)}(e,t.provider,t.isTokenAutoRefreshEnabled),h(e).isTokenAutoRefreshEnabled&&O(i,"INTERNAL",()=>{}),i}let X="app-check-internal";(0,n.Xd)(new i.wA("app-check",e=>new j(e.getProvider("app").getImmediate(),e.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider(X).initialize()})),(0,n.Xd)(new i.wA(X,e=>{var t;return t=e.getProvider("app-check").getImmediate(),{getToken:e=>$(t,e),getLimitedUseToken:()=>N(t),addTokenListener:e=>O(t,"INTERNAL",e),removeTokenListener:e=>B(t.app,e)}},"PUBLIC").setInstantiationMode("EXPLICIT")),(0,n.KN)("@firebase/app-check","0.8.8")}}]);